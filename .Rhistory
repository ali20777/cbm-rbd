tstarsi <- aggregate(gnow ~ tnow, res, which.min)
tstarsi <- taustarsi$gnow + (seqlen - 1) * (0:(length(tnowvec) - 1))
tstars <- res$t[taustarsi]
taustars <- tstars - tnowvec
data.frame(tnow = tnowvec, taustar = taustars, tstar = tstars, cstar = cstars)
}
brtaus1 <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0,8), hor=10)
taustarhist <- function(sys, ctypes, compfts, n0y0, beta, tnowvec, hor, seqlen = 101, prior = FALSE,
cu = 1, cp = 0.2, onecycle = TRUE){
res <- gnowhist(sys = sys, ctypes = ctypes, compfts = compfts, n0y0 = n0y0, beta = beta,
tnowvec = tnowvec, hor = hor, seqlen = seqlen, prior = prior, cu = cu, cp = cp, onecycle = onecycle)
res <- subset(res, !is.na(res$gnow))
cstars <- aggregate(gnow ~ tnow, res, min)
tstarsi <- aggregate(gnow ~ tnow, res, which.min)
tstarsi <- tstarsi$gnow + (seqlen - 1) * (0:(length(tnowvec) - 1))
tstars <- res$t[tstarsi]
taustars <- tstars - tnowvec
data.frame(tnow = tnowvec, taustar = taustars, tstar = tstars, cstar = cstars)
}
brtaus1 <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0,8), hor=10)
brtaus1
taustarhist <- function(sys, ctypes, compfts, n0y0, beta, tnowvec, hor, seqlen = 101, prior = FALSE,
cu = 1, cp = 0.2, onecycle = TRUE){
res <- gnowhist(sys = sys, ctypes = ctypes, compfts = compfts, n0y0 = n0y0, beta = beta,
tnowvec = tnowvec, hor = hor, seqlen = seqlen, prior = prior, cu = cu, cp = cp, onecycle = onecycle)
res <- subset(res, !is.na(res$gnow))
cstars <- aggregate(gnow ~ tnow, res, min)$gnow
tstarsi <- aggregate(gnow ~ tnow, res, which.min)
tstarsi <- tstarsi$gnow + (seqlen - 1) * (0:(length(tnowvec) - 1))
tstars <- res$t[tstarsi]
taustars <- tstars - tnowvec
data.frame(tnow = tnowvec, taustar = taustars, tstar = tstars, cstar = cstars)
}
asdf$t[aggregate(gnow ~ tnow, asdf, which.min)$gnow + 100 * (0:4)]
brtaus1 <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0,2,4,6,8), hor=10)
brtaus1
brtaus1 <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0,2,4,6,8), hor=2)
brtaus1
brtaus1 <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0,2,4,6,8), hor=2, seqlen = 21)
brtaus1
brtaus1 <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0,2,4,6,8), hor=10, seqlen = 501)
brtaus1
brtaus1fine <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, seq(0,2,by=0.1), hor=2, seqlen=201)
brtaus1fine
tauhistfig1 <- ggplot(melt(brtaus1fine, tnow), aes(x = t, y = value))+ xlab(expression(t)) +
geom_line(aes(colour = variable)) + guides(colour = guide_legend(title=NULL))
tauhistfig1 <- ggplot(melt(brtaus1fine, "tnow"), aes(x = t, y = value))+ xlab(expression(t)) +
geom_line(aes(colour = variable)) + guides(colour = guide_legend(title=NULL))
tauhistfig1
asdf <- melt(brtaus1fine, "tnow")
head(asdf)
tauhistfig1 <- ggplot(melt(brtaus1fine, "tnow"), aes(x = t, y = value)) + xlab(expression(t)) +
geom_line(aes(colour = variable, group = variable)) + guides(colour = guide_legend(title=NULL))
tauhistfig1
table(asdf$variable)
tauhistfig1 <- ggplot(melt(brtaus1fine, "tnow"), aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable, group = variable)) + guides(colour = guide_legend(title=NULL))
tauhistfig1
ghistfig1
brtaus1fine <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, seq(0,8,by=0.1), hor=2, seqlen=201)
tauhistfig1 <- ggplot(melt(brtaus1fine, "tnow"), aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable, group = variable)) + guides(colour = guide_legend(title=NULL))
tauhistfig1
brcompfts
tauhistfig1 <- ggplot(melt(brtaus1fine, "tnow"), aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable, group = variable)) +
geom_point(aes(colour = variable, group = variable)) + guides(colour = guide_legend(title=NULL))
tauhistfig1
ghistfig1
brghist1 <- gnowhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0,2,4,6,8), hor = 10, cp = 0.5)
brghist1a <- brghist1
names(brghist1a)[c(3,4)] <- c("Reliability", "Unit cost rate")
brghist1a <- melt(brghist1a, c("tnow", "t"))
brghist1a <- subset(brghist1a, !is.na(value))
ghistfig1 <- ggplot(brghist1a, aes(x = t, y = value)) + ylim(0, 1) +
geom_line(aes(colour = tnow, linetype = variable)) + xlab(expression(t)) +
ylab(expression(paste(R[sys]^(t[now]), (t), " and ", g^(t[now]), (t)))) +
#theme(legend.position = 'bottom', legend.direction = 'horizontal') +
guides(colour=guide_legend(title=expression(t[now])), linetype=guide_legend(title=NULL))
ghistfig1
brghist1a <- brghist1
names(brghist1a)[c(3,4)] <- c("Reliability", "Unit cost rate")
brghist1a <- melt(brghist1a, c("tnow", "t"))
brghist1a <- subset(brghist1a, !is.na(value))
ghistfig1 <- ggplot(brghist1a, aes(x = t, y = value)) + ylim(0, 1) +
geom_line(aes(colour = tnow, linetype = variable)) + xlab(expression(t)) +
ylab(expression(paste(R[sys]^(t[now]), (t), " and ", g^(t[now]), (t)))) +
#theme(legend.position = 'bottom', legend.direction = 'horizontal') +
guides(colour=guide_legend(title=expression(t[now])), linetype=guide_legend(title=NULL))
ghistfig1
head(brghist1a)
brghist1 <- gnowhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0,2,4,6,8), hor = 10, seqlen = 201, cp = 0.5)
brghist1$tnow <- as.factor(brghist1$tnow)
brghist1a <- brghist1
names(brghist1a)[c(3,4)] <- c("Reliability", "Unit cost rate")
brghist1a <- melt(brghist1a, c("tnow", "t"))
brghist1a <- subset(brghist1a, !is.na(value))
ghistfig1 <- ggplot(brghist1a, aes(x = t, y = value)) + ylim(0, 1) +
geom_line(aes(colour = tnow, linetype = variable)) + xlab(expression(t)) +
ylab(expression(paste(R[sys]^(t[now]), (t), " and ", g^(t[now]), (t)))) +
#theme(legend.position = 'bottom', legend.direction = 'horizontal') +
guides(colour=guide_legend(title=expression(t[now])), linetype=guide_legend(title=NULL))
ghistfig1
brtaus1fine <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, seq(0,8,by=0.1), hor=2, seqlen=201, cp = 0.5)
brtaus1fine <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, seq(0,8,by=0.1), hor=4, seqlen=401, cp = 0.5)
tauhistfig1 <- ggplot(melt(brtaus1fine, "tnow"), aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable, group = variable)) +
geom_point(aes(colour = variable, group = variable)) + guides(colour = guide_legend(title=NULL))
tauhistfig1
pdf("ghistfig1.pdf", width = 8, height = 4)
ghistfig1
dev.off()
ghistfig1 <- ggplot(brghist1a, aes(x = t, y = value)) + coord_cartesian(ylim = c(0, 1)) +
geom_line(aes(colour = tnow, linetype = variable)) + xlab(expression(t)) +
ylab(expression(paste(R[sys]^(t[now]), (t), " and ", g^(t[now]), (t)))) +
#theme(legend.position = 'bottom', legend.direction = 'horizontal') +
guides(colour=guide_legend(title=expression(t[now])), linetype=guide_legend(title=NULL))
pdf("ghistfig1.pdf", width = 8, height = 4)
ghistfig1
dev.off()
brn0y0
brcompfts <- list(C1 = NA, C2 = 6, C3 = 7, C4 = NA, H = 8, M = NA, P1 = 4, P2 = 3, P3 = 4, P4 = NA)
brhist1 <- sysrelnowhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0,8), hor=10)
brhist1$tnow <- as.factor(brhist1$tnow)
histfig1 <- ggplot(brhist1, aes(x = t, y = rel)) + ylim(0, 1) +
geom_line(aes(group = tnow, colour = tnow)) + xlab(expression(t)) + ylab(expression(R(t)))
histfig1
brhist1prio <- sysrelnowhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0,8), hor=10, prior = TRUE)
histfig2 <- ggplot(rbind(data.frame(updated = "yes", brhist1),
data.frame(updated = "no", brhist1prio)), aes(x = t, y = rel)) + ylim(0, 1) +
geom_line(aes(colour = tnow, linetype = updated)) + xlab(expression(t)) + ylab(expression(R(t)))
histfig2
brgnow0 <- gnowhor(brsysign, brn0y0, brbeta, brfts0, tnow=0, hor=10, seqlen=201)
qplot(brgnow0$tau, brgnow0$gnow, geom="line") + coord_cartesian(ylim=c(0,1))
brgnow8 <- gnowhor(br8sysign, brn0y0, brbeta, brfts8, tnow=8, hor=10, seqlen=201)
qplot(brgnow8$tau, brgnow8$gnow, geom="line")
brghist1 <- gnowhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0,2,4,6,8), hor = 10, seqlen = 201, cp = 0.5)
brghist1$tnow <- as.factor(brghist1$tnow)
ghistfig1 <- ggplot(brghist1, aes(x = t)) + ylim(0, 1) +
geom_line(aes(group = tnow, colour = tnow, y = gnow), linetype = 1) + xlab(expression(t)) +
geom_line(aes(group = tnow, colour = tnow, y = rel), linetype = 2)  + ylab(expression(paste(R[sys]^(t[now]), (t), " and ",
g^(t[now]), (t))))
ghistfig1 + guides(colour=guide_legend(title=expression(t[now])))
ghistfig1 <- ggplot(brghist1, aes(x = t)) + coord_cartesian(ylim=c(0,1)) +
geom_line(aes(group = tnow, colour = tnow, y = gnow), linetype = 1) + xlab(expression(t)) +
geom_line(aes(group = tnow, colour = tnow, y = rel), linetype = 2)  + ylab(expression(paste(R[sys]^(t[now]), (t), " and ",
g^(t[now]), (t))))
ghistfig1 + guides(colour=guide_legend(title=expression(t[now])))
ghistfig1 <- ggplot(brghist1, aes(x = t)) + coord_cartesian(ylim=c(0,2)) +
geom_line(aes(group = tnow, colour = tnow, y = gnow), linetype = 1) + xlab(expression(t)) +
geom_line(aes(group = tnow, colour = tnow, y = rel), linetype = 2)  + ylab(expression(paste(R[sys]^(t[now]), (t), " and ",
g^(t[now]), (t))))
ghistfig1 + guides(colour=guide_legend(title=expression(t[now])))
ghistfig1 <- ggplot(brghist1, aes(x = t)) + coord_cartesian(ylim=c(0,4)) +
geom_line(aes(group = tnow, colour = tnow, y = gnow), linetype = 1) + xlab(expression(t)) +
geom_line(aes(group = tnow, colour = tnow, y = rel), linetype = 2)  + ylab(expression(paste(R[sys]^(t[now]), (t), " and ",
g^(t[now]), (t))))
ghistfig1 + guides(colour=guide_legend(title=expression(t[now])))
brghist1a <- brghist1
names(brghist1a)[c(3,4)] <- c("Reliability", "Unit cost rate")
brghist1a <- melt(brghist1a, c("tnow", "t"))
brghist1a <- subset(brghist1a, !is.na(value))
ghistfig1 <- ggplot(brghist1a, aes(x = t, y = value)) + coord_cartesian(ylim = c(0, 1)) +
geom_line(aes(colour = tnow, linetype = variable)) + xlab(expression(t)) +
ylab(expression(paste(R[sys]^(t[now]), (t), " and ", g^(t[now]), (t)))) +
#theme(legend.position = 'bottom', legend.direction = 'horizontal') +
guides(colour=guide_legend(title=expression(t[now])), linetype=guide_legend(title=NULL))
ghistfig1
ghistfig1 <- ggplot(brghist1a, aes(x = t, y = value)) + #coord_cartesian(ylim = c(0, 1)) +
geom_line(aes(colour = tnow, linetype = variable)) + xlab(expression(t)) +
ylab(expression(paste(R[sys]^(t[now]), (t), " and ", g^(t[now]), (t)))) +
#theme(legend.position = 'bottom', legend.direction = 'horizontal') +
guides(colour=guide_legend(title=expression(t[now])), linetype=guide_legend(title=NULL))
ghistfig1
ghistfig1 <- ggplot(brghist1a, aes(x = t, y = value)) + # coord_cartesian(ylim = c(0, 4)) +
geom_line(aes(colour = tnow, linetype = variable)) + xlab(expression(t)) +
ylab(expression(paste(R[sys]^(t[now]), (t), " and ", g^(t[now]), (t)))) +
#theme(legend.position = 'bottom', legend.direction = 'horizontal') +
#guides(colour=guide_legend(title=expression(t[now])), linetype=guide_legend(title=NULL))
facet_grid(variable ~ .) + guides(colour=guide_legend(title=expression(t[now])))
ghistfig1
ghistfig1 <- ggplot(brghist1a, aes(x = t, y = value)) + # coord_cartesian(ylim = c(0, 4)) +
#geom_line(aes(colour = tnow, linetype = variable)) + xlab(expression(t)) +
geom_line(aes(colour = tnow)) + xlab(expression(t)) +
ylab(expression(paste(R[sys]^(t[now]), (t), " and ", g^(t[now]), (t)))) +
#theme(legend.position = 'bottom', legend.direction = 'horizontal') +
#guides(colour=guide_legend(title=expression(t[now])), linetype=guide_legend(title=NULL))
facet_grid(variable ~ ., scales = "free") + guides(colour=guide_legend(title=expression(t[now])))
ghistfig1
ghistfig1 <- ggplot(brghist1a, aes(x = t, y = value)) + # coord_cartesian(ylim = c(0, 4)) +
#geom_line(aes(colour = tnow, linetype = variable)) + xlab(expression(t)) +
geom_line(aes(colour = tnow)) + xlab(expression(t)) +
ylab(expression(paste(R[sys]^(t[now]), (t), " and ", g^(t[now]), (t)))) +
#theme(legend.position = 'bottom', legend.direction = 'horizontal') +
#guides(colour=guide_legend(title=expression(t[now])), linetype=guide_legend(title=NULL))
facet_wrap(~variable, nrow=1, scales = "free") + guides(colour=guide_legend(title=expression(t[now])))
ghistfig1
ghistfig1 <- ggplot(brghist1a, aes(x = t, y = value)) + # coord_cartesian(ylim = c(0, 4)) +
#geom_line(aes(colour = tnow, linetype = variable)) + xlab(expression(t)) +
geom_line(aes(colour = tnow)) + xlab(expression(t)) +
ylab(expression(paste(R[sys]^(t[now]), (t), " and ", g^(t[now]), (t)))) +
#theme(legend.position = 'bottom', legend.direction = 'horizontal') +
#guides(colour=guide_legend(title=expression(t[now])), linetype=guide_legend(title=NULL))
facet_wrap(~variable, nrow=2, scales = "free") + guides(colour=guide_legend(title=expression(t[now])))
ghistfig1
?facet_wrap
ghistfig1 <- ggplot(brghist1a, aes(x = t, y = value)) + # coord_cartesian(ylim = c(0, 4)) +
#geom_line(aes(colour = tnow, linetype = variable)) + xlab(expression(t)) +
geom_line(aes(colour = tnow)) + xlab(expression(t)) +
ylab(expression(paste(g^(t[now]), (t), " and ", R[sys]^(t[now]), (t)))) +
#theme(legend.position = 'bottom', legend.direction = 'horizontal') +
#guides(colour=guide_legend(title=expression(t[now])), linetype=guide_legend(title=NULL))
facet_wrap(~variable, nrow=2, scales = "free_y") + guides(colour=guide_legend(title=expression(t[now])))
ghistfig1
br <- graph.formula(s -- M -- C1:C2:C3:C4, P1:P2:P3:P4 -- t,
C1 -- P1, C2 -- P2, C3 -- P3, C4 -- P4, s -- H -- P3:P4)
brctypes <- list("C"=c("C1", "C2", "C3", "C4"), "H"=c("H"), "M"=c("M"), "P"=c("P1", "P2", "P3", "P4"))
br <- setCompTypes(br, brctypes)
brsysign <- computeSystemSurvivalSignature(br)
brbeta <- c(2, 1.2, 2.5, 1.5)
brn0y0 <- list(C=c(1, failuretolambda(8, brbeta[1])),
H=c(1, failuretolambda(2, brbeta[2])),
M=c(2, failuretolambda(5, brbeta[3])),
P=c(1, failuretolambda(3, brbeta[4])))
brcompfts <- list(C1 = NA, C2 = 6, C3 = 7, C4 = NA, H = 8, M = NA, P1 = 4, P2 = 3, P3 = 4, P4 = NA)
brhist1 <- sysrelnowhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0,8), hor=10)
brhist1$tnow <- as.factor(brhist1$tnow)
histfig1 <- ggplot(brhist1, aes(x = t, y = rel)) + ylim(0, 1) +
geom_line(aes(group = tnow, colour = tnow)) + xlab(expression(t)) + ylab(expression(R(t)))
histfig1
brhist1prio <- sysrelnowhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0,8), hor=10, prior = TRUE)
histfig2 <- ggplot(rbind(data.frame(updated = "yes", brhist1),
data.frame(updated = "no", brhist1prio)), aes(x = t, y = rel)) + ylim(0, 1) +
geom_line(aes(colour = tnow, linetype = updated)) + xlab(expression(t)) + ylab(expression(R(t)))
histfig2
brgnow0 <- gnowhor(brsysign, brn0y0, brbeta, brfts0, tnow=0, hor=10, seqlen=201)
qplot(brgnow0$tau, brgnow0$gnow, geom="line") + coord_cartesian(ylim=c(0,1))
brgnow8 <- gnowhor(br8sysign, brn0y0, brbeta, brfts8, tnow=8, hor=10, seqlen=201)
qplot(brgnow8$tau, brgnow8$gnow, geom="line")
qplot(brgnow8$tau, brgnow8$gnow, geom="line") + coord_cartesian(ylim=c(0,1))
brghist1 <- gnowhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0,2,4,6,8), hor = 10, seqlen = 201, cp = 0.25)
brghist1$tnow <- as.factor(brghist1$tnow)
ghistfig1 <- ggplot(brghist1, aes(x = t)) + coord_cartesian(ylim=c(0,4)) +
geom_line(aes(group = tnow, colour = tnow, y = gnow), linetype = 1) + xlab(expression(t)) +
geom_line(aes(group = tnow, colour = tnow, y = rel), linetype = 2)  + ylab(expression(paste(R[sys]^(t[now]), (t), " and ",
g^(t[now]), (t))))
ghistfig1 + guides(colour=guide_legend(title=expression(t[now])))
brghist1 <- gnowhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0,2,4,6,8), hor = 10, seqlen = 201, cp = 0.2)
brghist1$tnow <- as.factor(brghist1$tnow)
ghistfig1 <- ggplot(brghist1, aes(x = t)) + coord_cartesian(ylim=c(0,4)) +
geom_line(aes(group = tnow, colour = tnow, y = gnow), linetype = 1) + xlab(expression(t)) +
geom_line(aes(group = tnow, colour = tnow, y = rel), linetype = 2)  + ylab(expression(paste(R[sys]^(t[now]), (t), " and ",
g^(t[now]), (t))))
ghistfig1 + guides(colour=guide_legend(title=expression(t[now])))
brghist1 <- gnowhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0,2,4,6,8), hor = 10, seqlen = 201)
#brghist1 <- gnowhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0:8), hor=10)
brghist1$tnow <- as.factor(brghist1$tnow)
ghistfig1 <- ggplot(brghist1, aes(x = t)) + coord_cartesian(ylim=c(0,4)) +
geom_line(aes(group = tnow, colour = tnow, y = gnow), linetype = 1) + xlab(expression(t)) +
geom_line(aes(group = tnow, colour = tnow, y = rel), linetype = 2)  + ylab(expression(paste(R[sys]^(t[now]), (t), " and ",
g^(t[now]), (t))))
ghistfig1 + guides(colour=guide_legend(title=expression(t[now])))
brcompfts <- list(C1 = NA, C2 = 6, C3 = 7, C4 = NA, H = NA, M = NA, P1 = NA, P2 = 3, P3 = 4, P4 = NA)
brghist1 <- gnowhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0,2,4,6,8), hor = 10, seqlen = 201)
brghist1$tnow <- as.factor(brghist1$tnow)
ghistfig1 <- ggplot(brghist1, aes(x = t)) + coord_cartesian(ylim=c(0,4)) +
geom_line(aes(group = tnow, colour = tnow, y = gnow), linetype = 1) + xlab(expression(t)) +
geom_line(aes(group = tnow, colour = tnow, y = rel), linetype = 2)  + ylab(expression(paste(R[sys]^(t[now]), (t), " and ",
g^(t[now]), (t))))
ghistfig1 + guides(colour=guide_legend(title=expression(t[now])))
ghistfig1 <- ggplot(brghist1, aes(x = t)) + coord_cartesian(ylim=c(0,1)) +
geom_line(aes(group = tnow, colour = tnow, y = gnow), linetype = 1) + xlab(expression(t)) +
geom_line(aes(group = tnow, colour = tnow, y = rel), linetype = 2)  + ylab(expression(paste(R[sys]^(t[now]), (t), " and ",
g^(t[now]), (t))))
ghistfig1 + guides(colour=guide_legend(title=expression(t[now])))
brghist1a <- brghist1
names(brghist1a)[c(3,4)] <- c("Reliability", "Unit cost rate")
brghist1a <- melt(brghist1a, c("tnow", "t"))
brghist1a <- subset(brghist1a, !is.na(value))
ghistfig1 <- ggplot(brghist1a, aes(x = t, y = value)) + # coord_cartesian(ylim = c(0, 4)) +
#geom_line(aes(colour = tnow, linetype = variable)) + xlab(expression(t)) +
geom_line(aes(colour = tnow)) + xlab(expression(t)) +
ylab(expression(paste(g^(t[now]), (t), " and ", R[sys]^(t[now]), (t)))) +
#theme(legend.position = 'bottom', legend.direction = 'horizontal') +
#guides(colour=guide_legend(title=expression(t[now])), linetype=guide_legend(title=NULL))
facet_wrap(~variable, nrow=2, scales = "free_y") + guides(colour=guide_legend(title=expression(t[now])))
ghistfig1
ghistfig1 <- ggplot(brghist1a, aes(x = t, y = value)) + coord_cartesian(ylim = c(0, 1)) +
geom_line(aes(colour = tnow, linetype = variable)) + xlab(expression(t)) +
#geom_line(aes(colour = tnow)) + xlab(expression(t)) +
ylab(expression(paste(g^(t[now]), (t), " and ", R[sys]^(t[now]), (t)))) +
#theme(legend.position = 'bottom', legend.direction = 'horizontal') +
guides(colour=guide_legend(title=expression(t[now])), linetype=guide_legend(title=NULL))
#facet_wrap(~variable, nrow=2, scales = "free_y") + guides(colour=guide_legend(title=expression(t[now])))
ghistfig1
brcompfts <- list(C1 = NA, C2 = 6, C3 = 7, C4 = NA, H = 8, M = NA, P1 = 4, P2 = 3, P3 = 4, P4 = NA)
brghist1 <- gnowhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0,2,4,6,8), hor = 10, seqlen = 201)
brghist1$tnow <- as.factor(brghist1$tnow)
ghistfig1 <- ggplot(brghist1, aes(x = t)) + coord_cartesian(ylim=c(0,1)) +
geom_line(aes(group = tnow, colour = tnow, y = gnow), linetype = 1) + xlab(expression(t)) +
geom_line(aes(group = tnow, colour = tnow, y = rel), linetype = 2)  + ylab(expression(paste(R[sys]^(t[now]), (t), " and ",
g^(t[now]), (t))))
ghistfig1 + guides(colour=guide_legend(title=expression(t[now])))
brghist1a <- brghist1
names(brghist1a)[c(3,4)] <- c("Reliability", "Unit cost rate")
brghist1a <- melt(brghist1a, c("tnow", "t"))
brghist1a <- subset(brghist1a, !is.na(value))
ghistfig1 <- ggplot(brghist1a, aes(x = t, y = value)) + coord_cartesian(ylim = c(0, 1)) +
geom_line(aes(colour = tnow, linetype = variable)) + xlab(expression(t)) +
#geom_line(aes(colour = tnow)) + xlab(expression(t)) +
ylab(expression(paste(g^(t[now]), (t), " and ", R[sys]^(t[now]), (t)))) +
#theme(legend.position = 'bottom', legend.direction = 'horizontal') +
guides(colour=guide_legend(title=expression(t[now])), linetype=guide_legend(title=NULL))
#facet_wrap(~variable, nrow=2, scales = "free_y") + guides(colour=guide_legend(title=expression(t[now])))
ghistfig1
ftschron
compfts
brcompfts
ftschron <- c(0, sort(unlist(compfts))) # when something happens
ftschron <- c(0, sort(unlist(brcompfts))) # when something happens
ftschron
brcompfts <- list(C1 = NA, C2 = 6, C3 = 7, C4 = NA, H = 8, M = NA, P1 = NA, P2 = 3, P3 = 4, P4 = NA)
brhist1 <- sysrelnowhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0,8), hor=10)
brhist1$tnow <- as.factor(brhist1$tnow)
histfig1 <- ggplot(brhist1, aes(x = t, y = rel)) + ylim(0, 1) +
geom_line(aes(group = tnow, colour = tnow)) + xlab(expression(t)) + ylab(expression(R(t)))
histfig1
brhist1prio <- sysrelnowhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0,8), hor=10, prior = TRUE)
histfig2 <- ggplot(rbind(data.frame(updated = "yes", brhist1),
data.frame(updated = "no", brhist1prio)), aes(x = t, y = rel)) + ylim(0, 1) +
geom_line(aes(colour = tnow, linetype = updated)) + xlab(expression(t)) + ylab(expression(R(t)))
histfig2
brgnow0 <- gnowhor(brsysign, brn0y0, brbeta, brfts0, tnow=0, hor=10, seqlen=201)
qplot(brgnow0$tau, brgnow0$gnow, geom="line") + coord_cartesian(ylim=c(0,1))
brgnow8 <- gnowhor(br8sysign, brn0y0, brbeta, brfts8, tnow=8, hor=10, seqlen=201)
qplot(brgnow8$tau, brgnow8$gnow, geom="line") + coord_cartesian(ylim=c(0,1))
brghist1 <- gnowhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0,2,4,6,8), hor = 10, seqlen = 201)
brghist1$tnow <- as.factor(brghist1$tnow)
ghistfig1 <- ggplot(brghist1, aes(x = t)) + coord_cartesian(ylim=c(0,1)) +
geom_line(aes(group = tnow, colour = tnow, y = gnow), linetype = 1) + xlab(expression(t)) +
geom_line(aes(group = tnow, colour = tnow, y = rel), linetype = 2)  + ylab(expression(paste(R[sys]^(t[now]), (t), " and ",
g^(t[now]), (t))))
ghistfig1 + guides(colour=guide_legend(title=expression(t[now])))
brghist1a <- brghist1
names(brghist1a)[c(3,4)] <- c("Reliability", "Unit cost rate")
brghist1a <- melt(brghist1a, c("tnow", "t"))
brghist1a <- subset(brghist1a, !is.na(value))
ghistfig1 <- ggplot(brghist1a, aes(x = t, y = value)) + coord_cartesian(ylim = c(0, 1)) +
geom_line(aes(colour = tnow, linetype = variable)) + xlab(expression(t)) +
#geom_line(aes(colour = tnow)) + xlab(expression(t)) +
ylab(expression(paste(g^(t[now]), (t), " and ", R[sys]^(t[now]), (t)))) +
#theme(legend.position = 'bottom', legend.direction = 'horizontal') +
guides(colour=guide_legend(title=expression(t[now])), linetype=guide_legend(title=NULL))
#facet_wrap(~variable, nrow=2, scales = "free_y") + guides(colour=guide_legend(title=expression(t[now])))
ghistfig1
pdf("ghistfig1.pdf", width = 8, height = 4)
ghistfig1
dev.off()
brcompfts <- list(C1 = NA, C2 = 6, C3 = 7, C4 = NA, H = NA, M = NA, P1 = NA, P2 = 3, P3 = 4, P4 = NA)
brghist1 <- gnowhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0,2,4,6,8), hor = 10, seqlen = 201)
brghist1$tnow <- as.factor(brghist1$tnow)
brghist1a <- brghist1
names(brghist1a)[c(3,4)] <- c("Reliability", "Unit cost rate")
brghist1a <- melt(brghist1a, c("tnow", "t"))
brghist1a <- subset(brghist1a, !is.na(value))
ghistfig1 <- ggplot(brghist1a, aes(x = t, y = value)) + coord_cartesian(ylim = c(0, 1)) +
geom_line(aes(colour = tnow, linetype = variable)) + xlab(expression(t)) +
#geom_line(aes(colour = tnow)) + xlab(expression(t)) +
ylab(expression(paste(g^(t[now]), (t), " and ", R[sys]^(t[now]), (t)))) +
#theme(legend.position = 'bottom', legend.direction = 'horizontal') +
guides(colour=guide_legend(title=expression(t[now])), linetype=guide_legend(title=NULL))
#facet_wrap(~variable, nrow=2, scales = "free_y") + guides(colour=guide_legend(title=expression(t[now])))
brcompfts
head(brghist1a)
head(brghist1)
dim(brghist1)
brcompfts
hnotfail <- subset(brghist1, "tnow" == 8)
dim(hnotfail)
head(brghist1)
hnotfail <- subset(brghist1, tnow == 8)
dim(hnotfail)
head(hnotfail)
plot(hnotfail$t, hnotfail$gnow, type="l")
brghist1$tnow <- as.factor(brghist1$tnow)
brghist1a <- brghist1
names(brghist1a)[c(3,4)] <- c("Reliability", "Unit cost rate")
brghist1a <- melt(brghist1a, c("tnow", "t"))
brghist1a <- subset(brghist1a, !is.na(value))
dim(brghist1a)
head(subset(brghist1a, tnow == 8))
head(subset(subset(brghist1a, tnow == 8), variable == "gnow")
)
head(subset(subset(brghist1a, tnow == 8), variable == "Unit cost rate"))
ghistfig1 <- ggplot(brghist1a, aes(x = t, y = value)) + coord_cartesian(ylim = c(0, 1)) +
geom_line(aes(colour = tnow, linetype = variable)) + xlab(expression(t)) +
#geom_line(aes(colour = tnow)) + xlab(expression(t)) +
ylab(expression(paste(g^(t[now]), (t), " and ", R[sys]^(t[now]), (t)))) +
#theme(legend.position = 'bottom', legend.direction = 'horizontal') +
guides(colour=guide_legend(title=expression(t[now])), linetype=guide_legend(title=NULL))
#facet_wrap(~variable, nrow=2, scales = "free_y") + guides(colour=guide_legend(title=expression(t[now])))
ghistfig1
brcompfts
pdf("ghistfig1.pdf", width = 8, height = 4)
ghistfig1
dev.off()
brcompfts <- list(C1 = NA, C2 = 6, C3 = 7, C4 = NA, H = 8,  M = NA, P1 = NA, P2 = 3, P3 = 4, P4 = NA)
brghist1 <- gnowhist(br, brctypes, brcompfts, brn0y0, brbeta, c(0,2,4,6,8), hor = 10, seqlen = 201)
brghist1$tnow <- as.factor(brghist1$tnow)
brghist1a <- brghist1
names(brghist1a)[c(3,4)] <- c("Reliability", "Unit cost rate")
brghist1a <- melt(brghist1a, c("tnow", "t"))
brghist1a <- subset(brghist1a, !is.na(value))
ghistfig1 <- ggplot(brghist1a, aes(x = t, y = value)) + coord_cartesian(ylim = c(0, 1)) +
geom_line(aes(colour = tnow, linetype = variable)) + xlab(expression(t)) +
#geom_line(aes(colour = tnow)) + xlab(expression(t)) +
ylab(expression(paste(g^(t[now]), (t), " and ", R[sys]^(t[now]), (t)))) +
#theme(legend.position = 'bottom', legend.direction = 'horizontal') +
guides(colour=guide_legend(title=expression(t[now])), linetype=guide_legend(title=NULL))
#facet_wrap(~variable, nrow=2, scales = "free_y") + guides(colour=guide_legend(title=expression(t[now])))
ghistfig1
ghistfig1 <- ggplot(brghist1a, aes(x = t, y = value)) + coord_cartesian(ylim = c(0, 4)) +
geom_line(aes(colour = tnow, linetype = variable)) + xlab(expression(t)) +
#geom_line(aes(colour = tnow)) + xlab(expression(t)) +
ylab(expression(paste(g^(t[now]), (t), " and ", R[sys]^(t[now]), (t)))) +
#theme(legend.position = 'bottom', legend.direction = 'horizontal') +
guides(colour=guide_legend(title=expression(t[now])), linetype=guide_legend(title=NULL))
#facet_wrap(~variable, nrow=2, scales = "free_y") + guides(colour=guide_legend(title=expression(t[now])))
ghistfig1
ghistfig1 <- ggplot(brghist1a, aes(x = t, y = value)) + coord_cartesian(ylim = c(0, 2.5)) +
geom_line(aes(colour = tnow, linetype = variable)) + xlab(expression(t)) +
#geom_line(aes(colour = tnow)) + xlab(expression(t)) +
ylab(expression(paste(g^(t[now]), (t), " and ", R[sys]^(t[now]), (t)))) +
#theme(legend.position = 'bottom', legend.direction = 'horizontal') +
guides(colour=guide_legend(title=expression(t[now])), linetype=guide_legend(title=NULL))
#facet_wrap(~variable, nrow=2, scales = "free_y") + guides(colour=guide_legend(title=expression(t[now])))
ghistfig1
ghistfig1 <- ggplot(brghist1a, aes(x = t, y = value)) + coord_cartesian(ylim = c(0, 2.2)) +
geom_line(aes(colour = tnow, linetype = variable)) + xlab(expression(t)) +
#geom_line(aes(colour = tnow)) + xlab(expression(t)) +
ylab(expression(paste(g^(t[now]), (t), " and ", R[sys]^(t[now]), (t)))) +
#theme(legend.position = 'bottom', legend.direction = 'horizontal') +
guides(colour=guide_legend(title=expression(t[now])), linetype=guide_legend(title=NULL))
#facet_wrap(~variable, nrow=2, scales = "free_y") + guides(colour=guide_legend(title=expression(t[now])))
ghistfig1
ghistfig1 <- ggplot(brghist1a, aes(x = t, y = value)) + coord_cartesian(ylim = c(0, 2.1)) +
geom_line(aes(colour = tnow, linetype = variable)) + xlab(expression(t)) +
#geom_line(aes(colour = tnow)) + xlab(expression(t)) +
ylab(expression(paste(g^(t[now]), (t), " and ", R[sys]^(t[now]), (t)))) +
#theme(legend.position = 'bottom', legend.direction = 'horizontal') +
guides(colour=guide_legend(title=expression(t[now])), linetype=guide_legend(title=NULL))
#facet_wrap(~variable, nrow=2, scales = "free_y") + guides(colour=guide_legend(title=expression(t[now])))
ghistfig1
pdf("ghistfig1.pdf", width = 8, height = 4)
ghistfig1
dev.off()
brtaus1fine <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, seq(0,8,by=0.1), hor=4, seqlen=401, cp = 0.5)
tauhistfig1 <- ggplot(melt(brtaus1fine, "tnow"), aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable, group = variable)) + ylab()
geom_point(aes(colour = variable, group = variable)) + guides(colour = guide_legend(title=NULL))
tauhistfig1 <- ggplot(melt(brtaus1fine, "tnow"), aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable, group = variable)) + ylab(element_blank())
geom_point(aes(colour = variable, group = variable)) + guides(colour = guide_legend(title=NULL))
tauhistfig1 <- ggplot(melt(brtaus1fine, "tnow"), aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable, group = variable)) + ylab(element_blank()) +
geom_point(aes(colour = variable, group = variable)) + guides(colour = guide_legend(title=NULL))
tauhistfig1
pdf("tauhistfig1.pdf", width = 8, height = 4)
tauhistfig1
dev.off()
brtaus1fine
head(brtaus1fine)
brcompfts
dim(brtaus1fine)
brtaus1fine[75:81,]
1/9.25
brtaus1fine <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, seq(0,8,by=0.1), hor=4, seqlen=401)
tauhistfig1 <- ggplot(melt(brtaus1fine, "tnow"), aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable, group = variable)) + ylab(element_blank()) +
geom_point(aes(colour = variable, group = variable)) + guides(colour = guide_legend(title=NULL))
tauhistfig1
pdf("tauhistfig1.pdf", width = 8, height = 4)
tauhistfig1
dev.off()
pdf("ghistfig1.pdf", width = 6, height = 3)
ghistfig1
dev.off()
pdf("tauhistfig1.pdf", width = 6, height = 3)
tauhistfig1
dev.off()
brtaus1fine[75:81,]
?geom_point
tauhistfig1 <- ggplot(melt(brtaus1fine, "tnow"), aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable, group = variable)) + ylab(element_blank()) +
geom_point(aes(colour = variable, group = variable), size = 1) + guides(colour = guide_legend(title=NULL))
tauhistfig1
pdf("tauhistfig1.pdf", width = 6, height = 3)
tauhistfig1
dev.off()
tauhistfig1 <- ggplot(melt(brtaus1fine, "tnow"), aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable, group = variable)) + ylab(element_blank()) +
geom_point(aes(colour = variable, group = variable), size = 0.8) + guides(colour = guide_legend(title=NULL))
pdf("tauhistfig1.pdf", width = 6, height = 3)
tauhistfig1
dev.off()
brtaus1fine <- taustarhist(br, brctypes, brcompfts, brn0y0, brbeta, seq(0,8,by=0.1), hor=4, seqlen=401)
tauhistfig1 <- ggplot(melt(brtaus1fine, "tnow"), aes(x = tnow, y = value)) + xlab(expression(t[now])) +
geom_line(aes(colour = variable, group = variable)) + ylab(element_blank()) +
geom_point(aes(colour = variable, group = variable), size = 0.5) + guides(colour = guide_legend(title=NULL))
pdf("tauhistfig1.pdf", width = 6, height = 3)
tauhistfig1
dev.off()
