\documentclass[authoryear]{elsarticle}

% ------------ packages -------------

\usepackage[utf8]{inputenc}
\usepackage[OT1]{fontenc}
\usepackage{graphicx}
\usepackage[english]{babel}

\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{bm}

\usepackage[usenames,dvipsnames]{xcolor}
\usepackage{booktabs}
\usepackage{tikz}

\usepackage{url}
\usepackage[bookmarks]{hyperref}

%\usetikzlibrary{shapes.misc,fit}
\usetikzlibrary{%
   arrows,%
   calc,%
   fit,%
   patterns,%
   plotmarks,%
   shapes.geometric,%
   shapes.misc,%
   shapes.symbols,%
   shapes.arrows,%
   shapes.callouts,%
   shapes.multipart,%
   shapes.gates.logic.US,%
   shapes.gates.logic.IEC,%
   er,%
   automata,%
   backgrounds,%
   chains,%
   topaths,%
   trees,%
   petri,%
   mindmap,%
   matrix,%
   calendar,%
   folding,%
   fadings,%
   through,%
   patterns,%
   positioning,%
   scopes,%
   decorations.fractals,%
   decorations.shapes,%
   decorations.text,%
   decorations.pathmorphing,%
   decorations.pathreplacing,%
   decorations.footprints,%
   decorations.markings,%
   shadows}

%\usepackage{hyperref}
%\usepackage[bookmarks]{hyperref}
%\usepackage[colorlinks=true,citecolor=red,linkcolor=black]{hyperref}

% ------------ custom defs -------------

\newcommand{\reals}{\mathbb{R}}
\newcommand{\posreals}{\reals_{>0}}
\newcommand{\posrealszero}{\reals_{\ge 0}}
\newcommand{\naturals}{\mathbb{N}}

\newcommand{\dd}{\,\mathrm{d}}

\newcommand{\mbf}[1]{\mathbf{#1}}
\newcommand{\bs}[1]{\boldsymbol{#1}}
\renewcommand{\vec}[1]{{\bm#1}}

\newcommand{\uz}{^{(0)}} % upper zero
\newcommand{\un}{^{(n)}} % upper n
\newcommand{\ui}{^{(i)}} % upper i

\newcommand{\ul}[1]{\underline{#1}}
\newcommand{\ol}[1]{\overline{#1}}

\newcommand{\Tsys}{T_\text{sys}}

\newcommand{\Rsys}{R_\text{sys}}
\newcommand{\lRsys}{\ul{R}_\text{sys}}
\newcommand{\uRsys}{\ol{R}_\text{sys}}

\newcommand{\fsys}{f_\text{sys}}
\newcommand{\Fsys}{F_\text{sys}}
\newcommand{\lFsys}{\ul{F}_\text{sys}}
\newcommand{\uFsys}{\ol{F}_\text{sys}}

\newcommand{\lgt}{\ul{g}}
\newcommand{\ugt}{\ol{g}}

\newcommand{\E}{\operatorname{E}}
\newcommand{\V}{\operatorname{Var}}
\newcommand{\wei}{\operatorname{Wei}} % Weibull Distribution
\newcommand{\ig}{\operatorname{IG}}   % Inverse Gamma Distribution

\newcommand{\El}{\ul{\operatorname{E}}}
\newcommand{\Eu}{\ol{\operatorname{E}}}

\def\yz{y\uz}
\def\yn{y\un}
%\def\yi{y\ui}
\newcommand{\yfun}[1]{y^{({#1})}}
\newcommand{\yfunl}[1]{\ul{y}^{({#1})}}
\newcommand{\yfunu}[1]{\ol{y}^{({#1})}}

\def\ykz{y\uz_k}
\def\ykn{y\un_k}

\def\yzl{\ul{y}\uz}
\def\yzu{\ol{y}\uz}
\def\ynl{\ul{y}\un}
\def\ynu{\ol{y}\un}
\def\yil{\ul{y}\ui}
\def\yiu{\ol{y}\ui}

\def\ykzl{\ul{y}\uz_k}
\def\ykzu{\ol{y}\uz_k}
\def\yknl{\ul{y}\un_k}
\def\yknu{\ol{y}\un_k}

\newcommand{\ykzfun}[1]{y\uz_{#1}}
\newcommand{\ykzlfun}[1]{\ul{y}\uz_{#1}}
\newcommand{\ykzufun}[1]{\ol{y}\uz_{#1}}

\def\nz{n\uz}
\def\nn{n\un}
%\def\ni{n\ui}
\newcommand{\nfun}[1]{n^{({#1})}}
\newcommand{\nfunl}[1]{\ul{n}^{({#1})}}
\newcommand{\nfunu}[1]{\ol{n}^{({#1})}}

\def\nkz{n\uz_k}
\def\nkn{n\un_k}
\newcommand{\nkzfun}[1]{n\uz_{#1}}
\newcommand{\nkzlfun}[1]{\ul{n}\uz_{#1}}
\newcommand{\nkzufun}[1]{\ol{n}\uz_{#1}}

\def\nzl{\ul{n}\uz}
\def\nzu{\ol{n}\uz}
\def\nnl{\ul{n}\un}
\def\nnu{\ol{n}\un}
\def\nil{\ul{n}\ui}
\def\niu{\ol{n}\ui}

\def\nkzl{\ul{n}\uz_k}
\def\nkzu{\ol{n}\uz_k}
\def\nknl{\ul{n}\un_k}
\def\nknu{\ol{n}\un_k}


\def\taut{\tau(\vec{t})}
\def\ttau{\tilde{\tau}}
\def\ttaut{\ttau(\vec{t})}

\def\MZ{\mathcal{M}\uz}
\def\MN{\mathcal{M}\un}

\def\MkZ{\mathcal{M}\uz_k}
\def\MkN{\mathcal{M}\un_k}

\def\PkZ{\Pi\uz_k}
\def\PkN{\Pi\un_k}
\newcommand{\PZi}[1]{\Pi\uz_{#1}}

\def\tnow{t_\text{now}}
\def\tpnow{t^+_\text{now}}


% ------------ options -------------

\allowdisplaybreaks

\journal{RESS}

\begin{document}

% ------------ frontmatter -------------

\begin{frontmatter}
\title{Condition-Based Maintenance for Systems based on Bayesian P-Box Component Models***}

\author[tue]{Gero Walter}
\ead{g.m.walter@tue.nl}
\author[tue]{Simme Douwe Flapper}
\ead{s.d.p.flapper@tue.nl}

\address[tue]{School of Industrial Engineering, Eindhoven University of Technology, Eindhoven, Netherlands}


\begin{abstract}
CBM when no (continuous) degradation signal for system available, but status of components observable (works yes/no)

use method from asce-asme paper:
gives RUL in form of a p-box (set of distributions), base maintenance decision directly on that
(via upper expected cost rate)

Bayesian approach allows
component models to include expert info, test data (if available), and status of components in the running system

main message: can do CBM for systems without degradation signal,
especially useful for redundant systems,
method reflects aleatory and epistemic uncertainty in all information sources
\end{abstract}

\begin{keyword}
condition-based maintenance \sep system reliability \sep remaining useful life \sep survival signature \sep imprecise probability \sep p-box
\end{keyword}
\end{frontmatter}


% ------------ manuscript -------------

\section{Introduction}
\label{intro}

CBM usually with directly or indirectly observable continuously measurable condition / degradation signal,
estimated time till failure (RUL) \citep{2014:rul-review, 2011:rul-review-statistical}
via distance of current signal level to fixed known failure threshold.
Inspection-based CBM via delay time model, modeling the time between detectable degradation and failure,
again time till failure via distance of current degradation level to fixed known failure threshold,
In both cases, maintenance decision via control limit / threshold for the signal, RUL not explicitely calculated.
%but in practice threshold often not known

Here we propose a different approach to CBM: if no degradation signal for system available,
use system layout (reliability block diagram) and information on components' status:
need only to observe when a component fails,
and expert information about expected component failure times.

We use a parametric model not for a degradation signal of the system or for the delay time, but for component lifetimes:
we use the well-known Weibull model for component lifetimes.
To keep the model simple, we assume known shape parameter,
and that components fail independently.
These simplifying assumptions might not hold in practice,
then the model can serve as a first approximation.

The Bayesian approach to the Weibull model allows to integrate, for each component type,
three sources of information: expert knowledge, data from component tests,
and status of components in the monitored system, i.e., current system condition.

Furthermore, our method appropriately reflects epistemic uncertainty,
by using sets of conjugate priors \citep{diss} for the component models.
The resulting sets of component posteriors are equivalent to parametric p-boxes,
an imprecise probability model popular in risk and reliability engineering.

These parametric posteriors are then used to calculate the exact distribution of system RUL,
we therefore accomplish the same as \cite{2013:si-et-al} for their situation.

***figure of process: set of component priors $\to$ set of component posteriors $\to$ system RUL $\to$ $g(\tau)$ $\to$ $\tau^*$

***single $\tau^*$ vs set of $\tau^*$: decision support

***discuss \cite{2015:sankararaman}, epistemic vs. aleatoric uncertainty: big topic in reliability and risk

***refer to Terje Aven, NASA Langley UQ challenge, illustration that uniform distribution does not express ignorance (Edoardo Patelli)***

***we go beyond what \cite{2015:sankararaman} recommends

The proposed system RUL model adequately reflects uncertainty in the RUL distribution
according to the current system status,
in particular making more cautious predictions when failure behaviour in the monitored system
seems to deviate from what is expected from expert knowledge and previous (test) data.

Expert input in our model is, for each component type,
Weibull shape parameter, range of expected failure time (translated to scale parameter),
and range of expert info weight (how sure about mean failure time guess).
By using ranges we do a systematic sensitivity analysis.

Our model gives lower and upper bounds for the distribution of time till system failure,
taking current (at time $\tnow$) system condition into account.

Based on this, the additional criteria of unit cost rate is used to indicate the optimal time for repair.
(Could also indicate which failed component(s) to repair best.)

An advantage of our approach is that
it indicates, for any current time $\tnow$, at which point in the future it is economical to repair the system,
thus allowing for set-up time for maintenance work.

***all expressed in time, but could also be in usage (number of cycles, etc).

\subsection{Literature***}

Example for Bayesian method in CBM via inspections: \cite{2007:wang-jia}
propose a model that uses Bayesian updating,
but the model aims to identify an optimal inspection interval.
%This is CBM via inspections, not CBM via continuous monitoring as we aim to do.

\begin{scriptsize}
Wang \& Jia (2007) have a model for defects arrival (homogeneous Poisson process with rate $\lambda$, so no aging),
model for delay time (time between defect and failure) is Weibull $h \sim \wei(\alpha,\beta)$,
and each of $\lambda, \alpha, \beta$ has a Gamma prior distribution.
The expected overall cost rate is then used to find a cost-optimal inspection interval.
For this they assume that failures are immediately repaired,
and defects found in an inspection are repaired during inspection.

They use prior predictive distributions for certain statistics (number of defects, number of failures, \ldots between $0$ and $T$)
to obtain prior values for the Gamma hyperparameters,
by solving prior predictive equations -- but give no detail on how they actually do this.

In the end they actually do not advocate to calculate the posterior expected cost rate (15),
but rather plug in posterior estimates for $\lambda, \alpha, \beta$,
so neglecting uncertainty in estimation.
(We do not assume a parametric distribution for delay time,
it rather arises as a consequence of the system layout and component failure distributions.)

\end{scriptsize}

Example for Bayesian method in CBM with continuous monitoring: \cite{2011:elwany-et-al}
(exponential degradation model, whose parameters $\theta'$ and $\beta$ each have a prior
which is updated using the degradation signal history,
and use total expected infinite-horizon discounted cost to determine the maintenance policy,
RUL not explicitely calculated)

Example for Bayesian method in prediction of system remaining useful life: \cite{2012:sun-et-al}
(constructs health index for a system based on sensor measurements,
health status prediction is updated sequentially,
leads to RUL distribution like our method,
but no link from RUL to maintenance decision)

\cite{2013:si-et-al} do CBM with continuous monitoring for a single component,
taking into account the whole degradation path history.
The authors provide exact expressions for the RUL distribution, which is updated in an empirical Bayesian framework using conjugate priors.
The RUL distribution is used to construct a replacement decision model using the unit cost rate via renewal reward
(eq. 35)\\
***this is most similar to what we do: exact RUL distribution $\to$ maintenance decision,
but we have component status instead of degradation signal as basis for RUL,
and we model epistemic uncertainties!\\

\cite{2011:kim-et-al} develop a periodic monitoring CBM policy
where a maintenance decision is triggered when
a Bayesian control chart (a sequentially updated health indicator) %posterior probability that system is in a 'warning' state
exceeds a control limit (threshold) that is determined
by minimizing the expected average cost per time unit.
(We use the same cost criterion, but base the maintenance decision directly on our exact RUL estimation.)

***typical recent example for Bayesian network models in maintenance -- could also cover system reliabilty terrain***
maybe Jones et al (RESS 95:3, 2010) ``The use of Bayesian network modelling for maintenance planning in a manufacturing industry'',
or Bouaziz et al (2013) ``Towards Bayesian network methodology for predicting equipment health factor of complex semiconductor systems''

\begin{scriptsize}
Bayesian networks (BNs) are a very general method to jointly model multiple dependent random variables in a Bayesian way. 
This needs assessments of conditional independece relations, and conditional probability models for each variable,
the latter often in form of conditional probability tables (discrete variables).
A Bayesian network models probabilistic relations between variables,
unlike a reliability block diagram, which gives a deterministic relation
between the status of components and the system state.

One could model a system as a BN (each component is a variable),
but that would add a lot of complications.
Most algorithms for BNs assume discrete distributions,
and do not scale well to large networks (many tasks are NP-hard).

The above papers seem to use a BN to model a degradation signal or (system) health index (have to check again to be sure).
Our approach is different, as we get an exact formulation for the system RUL directly.

\end{scriptsize}


\section{***summary of ASCE-ASME paper method}

sets of priors on component survival,
survival signature,
test data inclusion
(write down explicit formula for test data including censored observations),
noninformatiove censoring,
set of system reliability curves as output,
wider set in case of prior-data conflict


\section{***extensions to ASCE-ASME paper method}
\label{sec:extensions}

when repaired/replaced components are present in system,
then one needs to use actual ages (and not time since system startup) in parameter update,
introduces new component type for $\Rsys(t)$ calculation but with same posterior parameters as unreplaced component type

repaired/replaced components require the creation of a separate type in the survival signature decomposition
and thus the calculation of separate posterior predictive probabilities
$P(C^k_t = l_k \mid \nkz,\ykz,\text{test data},\text{monitoring data})$,
which use, however, the same hyperparameter learning (using actual component ages) as the `parent type'.

output is a set of current system reliability curves
taking into account the current system state,
including the current ages of system components, 
and the lifetime histories of all component types,
including test data and expert assessments.
The set of current, updated system reliability curves gives a RUL estimate
in the form of a p-box, thus reflecting both aleatoric and epistemic uncertainty in the estimate.


\section{***from (set of) reliability curves to maintenance decision}

To find the optimal moment for maintenance based on the current set of system reliability curves,
we minimize the expected average cost per time unit,
or unit cost rate, $g(\tau)$ %, where $\tau$ is the moment when preventive maintenance is exectued.
(could be discounted as well, out of scope here.)

In the literature, commonly two ways to calculate the unit cost rate are considered,
a renewal reward theory based long-term unit cost rate $g_r(\tau)$,
and the one-cycle cost rate $g_1(\tau)$ \citep{1996:mazzuchi-soyer}.
We will discuss both approaches here with their advantages and disadvanatges.

Let $c_p$ be the cost of planned / preventive maintenance, and $c_u$ the cost of unplanned / breakdown maintenance, where $c_p < c_u$.

\subsection{***unit cost rate via renewal reward}

The renewal reward theory based approach considers the unit cost rate as a long-term average,
where the proposed policy is used over a large number of replacement cycles,
and cycles can be seen as stochastic copies of each other.
Under this assumption, the unit cost rate is, according to renewal theory,
given as the expected cycle cost $ECC(\tau)$ divided by the expected cycle length $ECL(\tau)$:
\begin{align}
g_r(\tau) &= \frac{ECC(\tau)}{ECL(\tau)} = \frac{c_p \Rsys(\tau) + c_u \big(1-\Rsys(\tau)\big)}{\tau \Rsys(\tau) + \int_0^\tau \Rsys(t) \dd t}\,,
\end{align}
and $\tau_r^* = \arg\min g_r(\tau) - \tnow$ is the cost-optimal repair time from now
(since $\Rsys(\cdot)$ is always in terms of time since system startup)

***most often used in literature \citep{2013:si-et-al}, \citep{2011:kim-et-al}

***stochastic copies assumption implies that the system is in the same state at the start of each cycle,
so $c_p$ needs to include the costs of replacing all components
to bring the system into the same state as at startup time.

\subsection{***one-cycle unit cost rate}

The one-cycle unit cost rate approach considers only the costs with respect to the current cycle.
Conditional on the (random) system failure time $\Tsys$, the unit cost rate is 
\begin{align*}
g_1(\tau \mid \Tsys) &=
\begin{cases}
c_p / \tau  & \text{if } \Tsys \ge \tau \\
c_u / \Tsys & \text{if } \Tsys < \tau
\end{cases}
\end{align*}

Taking the expectation over $\Tsys$ leads to the unit cost rate being
\begin{align*}
g_1(\tau) &= \E[g_1(\tau \mid \Tsys)] = \frac{c_p}{\tau} \Rsys(\tau) + c_u \int_0^\tau \frac{1}{t} \fsys(t) \dd t
\end{align*}
***here, $\Rsys(\cdot)$ shifted such that $\tnow = 0$.

Due to our extensions from Section~\ref{sec:extensions},
maintenance work can consist of replacing (or returning to an as-good-as-new state) some or all failed or non-failed components,
as arbitrary component ages can be taken into account.
(However, computation times decrease when all components of the same type are replaced at the same time,
as then the duplication of component types for the survival signature decomposition is not necessary.)


\subsection{***bounds for unit cost rate}

Bounds for $\Rsys(t)$ lead to bounds for $g(\tau)$.
%For each $\tau$, fix $\Rsys(\tau) \in [\lRsys(\tau), \uRsys(\tau)]$ and optimize $I(\tau) = \int_0^\tau \Rsys(t) \dd t$
%nonparametrically: $\ol{I}(\tau)$ by $\uRsys(t)$, $\ul{I}(\tau)$ by $\lRsys(t)$ until level of $\Rsys(\tau)$.
Can get bounds $\lgt(\tau)$ and $\ugt(\tau)$ in the same way as bounds $\lRsys(t)$ and $\uRsys(t)$ in ASCE-ASME paper:
need to optimize only over
$\nkzfun{1} \in \left[\nkzlfun{1}, \nkzufun{1}\right], \ldots, \nkzfun{K} \in \left[\nkzlfun{K}, \nkzufun{K}\right]$.

This works because, like $\Rsys(t)$, also $g(\tau)$ is monotone in $\ykzfun{1}, \ldots \ykzfun{K}$:
$\Rsys(\tau)$ is monotone in $\ykzfun{1}, \ldots \ykzfun{K}$ (ASCE-ASME paper),
and $g(\tau)$ is monotonely decreasing in $\Rsys(\tau)$:

First look at $I(\tau) := \int_0^\tau \Rsys(t) \dd t$.
A lower bound for $I(\tau)$ is $\tau \Rsys(\tau)$ (obtained when $\Rsys(t)$ drops to $\Rsys(\tau)$ immediately after $t=0$),
and an upper bound for $I(\tau)$ is $\tau$ (obtained when $\Rsys(t)$ remains at $1$ until immediately prior to $t = \tau$).
Therefore, for each $\tau$ and $\Rsys(\tau)$ there exists a constant $R^* \in [\Rsys(\tau), 1]$
such that $I(\tau) = \tau R^*$.
Note that $R^*$ increases when $\Rsys(\tau)$ increases.

Setting $\Rsys(\tau) =: R$ and $g(\tau) =: g$ to simplify notation, we get
\begin{align*}
g &= \frac{c_p R + c_u (1-R)}{\tau R + \tau R^*}
   = \frac{(c_p - c_u) R + c_u}{\tau R + \tau R^*}\,.
\end{align*}
As $(c_p -c_u) < 0$, the enumerator of $g$ is monotonely decreasing in $R$.
The denominator of $g$ is monotonely increasing in $R$, since $R^*$ must increase when $R$ increases.
In total, $g$ is thus monotonely decreasing in $R$.

***formulate above as theorem?


\subsection{***from bounds for $g(\tau)$ to (set of) $\tau^*$:}

%worst case, best case, interval (how?)
\begin{itemize}
\item worst case (minimax strategy): minimizing $\ugt(\tau)$ leads to $\tau^*_u$.
\item interval dominance: for each $\tau$, we get a $g(\tau)$ interval $[\lgt(\tau), \ugt(\tau)]$.
Throw out all $\tau$'s for which $\lgt(\tau) \ge \ugt(\tau^*_u)$.
This will leave us with the set of $\tau$'s that are not dominated by $\tau^*_u$.
(The set will be quite wide probably.)
\item parametric / maximality (?): collect all $\tau$'s for which there is a prior parameter combination such that $\tau$ minimizes $g(\tau)$.
(Need to do grid search over $\nkz$'s, or keep optimal pars when calculating $\lgt(\tau)$.)
\end{itemize}

\subsection{***simple 95\% policy}

Or, alternatively to all the above, simple 95\% policy?
Repair time from now such that lower system reliability is at least 95\%, i.e., upper system failure probability is at most 5\%.


\section{Case study / numerical example}

which system layout? something that demonstrates the power of the method (complex layout) or something simple?

complex: e.g., bridge system where each of the four elements is a two out of three, and the bridge element is a two-parallel.

or the simplified brake system from ASCE-ASME paper?


\section{Outlook}

*** to use the model for inspection-based CBM (if no repair necessary, find optimal timing of next inspection),
we would need to add interval-censored data (failure has happened between last and current inspection)



\section*{Acknowledgements}

CAMPI


\section*{Bibliography}

\bibliographystyle{elsarticle-harv}

\bibliography{refs}

\end{document}
